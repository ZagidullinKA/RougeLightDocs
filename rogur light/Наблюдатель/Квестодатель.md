Переменные:
QuestAmount -- int
QuestTypeToSpawn -- string


Типы квестов:
1. Цепочка точек. chain
2. Убийство типа мобов. (ВТЧ any) KOS
3. Убить новую пачку врагов за время. newBorn

Уровни сложности квестов:
1. Легкий easy
2. Средний middle
3. Сложный hard


{
"code": "EZ1"
"nameRu": "Первый легкий квест"
"lvl": "easy",
"amount": 3
"distance": 25
"typeToSpawn": "melee",
"time": 20
"price": 5
}

**Метод создания квеста**
1. Определить сложность квеста: с шансом в 50% -- легкий, 35% -- средний, 15% -- тяжелый.
2. Найти в [[Справочник параметров квестов]] случайную запись с подходящим lvl.
3. Случайным образом определить тип квеста, и сгенерировать квест, используя полученные данные:
	1. Если type = chain:
		1. определить время завершения квеста как now + time. передать результат (timeWhenEnd) в **Метод обработки квеста chain**
		2. на расстоянии в disance от игрока сгенерировать [[Препятствие]] questWayPoint, передав в него distance
		3. QuestAmount = amount
		4. **Метод обработки квеста chain**, передав в него price и amount
	2. Если type = KOS
		1. Проверить, что в spawnList есть враги с типом typeToSpawn. Если нет, добавить их в spawnList ([[Наблюдатель]])
			1. Передать в **Метод обработки квеста KOS** amount, typeToSpawn, price
		2. Если в spawnList была добавлена запись, убрать её. 
	3. Если type = newBorn
		1. определить время завершения квеста как now + time. передать результат (timeWhenEnd) в **Метод обработки квеста newBorn**
		2. QuestAmount = amount
		3. QuestTypeToSpawn = typeToSpawn +"Quest"
		4. С помощью **метод предопределения мобов по типу** [[Основная генерация]] сгенерировать мобов, передав в него массив из значения QuestTypeToSpawn
		5. **Метод обработки квеста chain**, передав в него price и amount



метод **WayPointChange**
Принимает значение distance
1. QuestAmount --
2. Проверить, что QuestAmount > 0, если да, то: 
	1. Сгенерировать не пересекающееся с другими препятствиями препятствие questWayPoint на расстоянии в distance


**(Кажется, асинхронное)Метод обработки квеста chain**
принимает timeWhenEnd, price, amount
1. Выполнять, пока значение значение времени не совпадает с принятым
	1. инициировать **Метод отображения состояния квеста с таймером**, передав в него price и непрерывно передавая в него QuestAmount и разницу в секундах между timeWhenEnd и сейчас.
	2. Передать в **Метод отображения состояния квеста** price
	3. Если QuestAmount = 0, добавить к записи money ([[Справочник денег]]) в amount количество price (money.amount += price), прекратить выполнение алгоритма.
2. Если совпадает, понизить все характеристики [[Игровой персонаж]] на price процентов.



**(Кажется, асинхронное)Метод обработки квеста KOS**
принимает amount, typeToSpawn, price
1. QuestAmount = amount
2. QuestTypeToSpawn = typeToSpawn
3. инициировать **Метод отображения состояния квеста без таймера**, передав в него price и непрерывно передавая в него QuestAmount и amount
4. Если QuestAmount = 0, добавить к записи money ([[Справочник денег]]) в amount количество price (money.amount += price), прекратить выполнение алгоритма.


**Метод обработки квеста newBorn**
Принимает принимает timeWhenEnd, price, typeToSpawn, amount
1. Выполнять, пока значение значение времени не совпадает с принятым
2.  Инициировать **Метод отображения состояния квеста с таймером**, передав в него price и непрерывно передавая в него QuestAmount, amount и разницу в секундах между timeWhenEnd и сейчас.
3. Если QuestAmount = 0, добавить к записи money ([[Справочник денег]]) в amount количество price (money.amount += price), прекратить выполнение алгоритма.


**Метод отображения состояния квеста с таймером**
Формирует блок отображения квеста, в котором отображает price за квест
актуальные timeWhenEnd и QuestAmount из amount (QuestAmount / amount. буквально. Не надо это делить.)

**Метод отображения состояния квеста без таймера**
Формирует блок отображения квеста, в котором отображает price за квест
актуальный QuestAmount из amount (QuestAmount / amount. буквально. Не надо это делить.)